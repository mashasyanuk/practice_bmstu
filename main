#include <iostream>
#include <string>
#include <stdlib.h>
#include <iomanip>
using namespace std;

//Составить список группы. Для каждого студента указать имя, фамилию, отчество, год поступления, группу, оценки по 4 предметам.
//Запрос: распечатать фамилию и имя студента, имеющего максимальный сред- ний балл среди студентов указанной группы.

int option;

int Menu() {
    cout << "____________________________________________________________________________" << endl;
    cout << "***   Набор задач по запросу:   ***"<< endl;
    cout << "1 - Создать список  студентов " << endl;
    cout << "2 - Показать студентов и информацию о них" << endl;
    cout << "3 - Изменить информацию о студенте" << endl;
    cout << "4 - Удалить информацию о студенте" << endl;
    cout << "5 - Добавить в список студентов"<< endl;
    cout << "6 - Сортировать студентов по" << endl;
    cout << "7 - Выйти" << endl;
    cout << "____________________________________________________________________________" << endl;
    cin >> option;
}

struct Student{
    char surname[40];
    char name[40];
    char patronymic[40];
    int year_enter{};
    char group[10];
    int rate_first_subject{},
            rate_second_subject{},
            rate_third_subject{},
            rate_forth_subject{};

};

void Data_Entery(Student* (&d), int& n ){

    cout << "О скольких студентах вы хотите ввести данные?"<< endl;
    cin >> n;
    d= new Student[n];

    cout << "____________________________________________________________________________" << endl;
    for(int i{}; i<n; i++){

        cout <<"Введите Фамилию, Имя и Отчество студента через Enter:  " << endl;
        cin >> d[i].surname;
        cin >> d[i].name;
        cin >> d[i].patronymic;

        cout << "Введите год поступления"<< endl;
        cin >> d[i].year_enter;

        cout << "Введите группу в которой состоит учащийся"<< endl;
        cin >> d[i].group;

        cout << "Введите оценки по Высокоуровневому программированию:  " << endl;
        cin >>d[i].rate_first_subject;

        cout << "Введите оценки по культурологии, аналитической геометрии и мат. анализу: " << endl;
        cin >>d[i].rate_second_subject;

        cout << "Введите оценки по аналитической геометрии:  " << endl;
        cin >>d[i].rate_third_subject;

        cout << "Введите оценки по математическому анализу: " << endl;
        cin >>d[i].rate_forth_subject;
        cout << "____________________________________________________________________________" << endl;
    }


}

void Print(Student* d, int n){
      cout <<fixed<<setw(10)<< "Данные № " <<setw(10)<< "|Фамилия    " <<setw(10)<< "|Имя      " <<setw(13)<< "|Отчество    " <<setw(16)<< "|Год поступления" <<setw(11)<< "|Группа   " <<setw(35)<< "|Высокоуровневое программирование   " <<setw(17)<< "|Культурология    " <<setw(20)<< "|Аналит. геометрия   " <<setw(15)<< "|Математ. анализ     " << endl;
//    printf ("%-10s|", "Данные № ");
//    printf ("%-10s|", "Фамилия    ");
//    printf ("%-10s|", "Имя      "  );
//    printf ("%-10s|", "Отчество    ");
//    printf ("%-16s|", "Год поступления");
//    printf ("%-11s|", "Группа   " );
//    printf ("%-35s|", "Высокоуровневое программирование" );
//    printf ("%-17s|", "Культурология    " );
//    printf ("%-20s|", "Аналит. геометрия   " );
//    printf ("%-15s|", "Математ. анализ     "  );
 //   printf("%-25s%-20s%-10s%-10s%-10s%-25s%-20s%-10s%-10s%-10s\n", "Данные № ", "Фамилия", "Имя", "Отчество", "Год поступления", "Группа", "ВП", "Культурология", "Аналит. геометрия", "Математ. анализ");

    for(int i{}; i<n; i++){
        cout << "____________________________________________________________________________" << endl;
        cout << fixed << left <<setw(11)<< i+1 << "|"<<setw(13)<< d[i].surname << "|"<<setw(10)<< d[i].name << "|"<<setw(12)<< d[i].patronymic << "|"<<setw(14)<<d[i].year_enter<< "|"<<setw(10)<< d[i].group << "|"<<setw(35)<< d[i].rate_first_subject << "|"<<setw(17)<< d[i].rate_second_subject << "|"<<setw(20)<< d[i].rate_third_subject << "|"<<setw(15)<< d[i].rate_forth_subject << endl;
//        printf ("%-10d|", i+1 );
//        printf ("%-10s|", d[i].surname);
//        printf ("%-10s|", d[i].name );
//        printf ("%-10s|", d[i].patronymic);
//        printf ("%-16d|", d[i].year_enter );
//        printf ("%-11s|", d[i].group );
//        printf ("%-35d|", d[i].rate_first_subject );
//        printf ("%-17d|", d[i].rate_second_subject  );
//        printf ("%-20d|", d[i].rate_third_subject );
//        printf ("%-15d|", d[i].rate_forth_subject  );
 //       printf("%-25d%-20s%-10s%-10s%-10d%-25s%-20d%-10d%-10d%-10d\n", i+1, d[i].surname, d[i].name, d[i].patronymic, d[i].year_enter,d[i].group , d[i].rate_first_subject , d[i].rate_second_subject, d[i].rate_third_subject, d[i].rate_forth_subject );




        cout << endl;
        cout << "____________________________________________________________________________" << endl;
    }

}


void Data_Change(Student* (&d), int n){
    int _n;
    cout << "Номер студента, запись которого нужно изменить(от 1 до "<< n <<" ):  ";
    cin >> _n;
    _n--;
    if (_n>0 && _n<n){
        int i=_n;
        cout <<"Введите Фамилию, Имя и Отчество студента через Enter:  " << endl;
        cin >> d[i].surname;
        cin >> d[i].name;
        cin >> d[i].patronymic;

        cout << "Введите год поступления"<< endl;
        cin >> d[i].year_enter;

        cout << "Введите группу в которой состоит учащийся"<< endl;
        cin >> d[i].group;

        cout << "Введите оценки по Высокоуровневому программированию:  " << endl;
        cin >>d[i].rate_first_subject;

        cout << "Введите оценки по культурологии, аналитической геометрии и мат. анализу: " << endl;
        cin >>d[i].rate_second_subject;

        cout << "Введите оценки по аналитической геометрии:  " << endl;
        cin >>d[i].rate_third_subject;

        cout << "Введите оценки по математическому анализу: " << endl;
        cin >>d[i].rate_forth_subject;


    }
    else{
        cout << "Студента с таким номером нет в списке" << endl;
    }
}

void Copy(Student* (&d_new), Student* (&d_old), int n){
    for(int i{}; i<n; i++){
        d_new[i]=d_old[i];
    }

}

void Copy_Elements(Student& d_new, Student& d_old){
    strcpy(d_new.surname, d_old.surname);
    strcpy(d_new.name, d_old.name);
    strcpy(d_new.patronymic, d_old.patronymic);

    d_new.year_enter=d_old.year_enter;

    strcpy(d_new.group, d_old.group);

    d_new.rate_first_subject=d_old.rate_first_subject;

    d_new.rate_second_subject=d_old.rate_second_subject;

    d_new.rate_third_subject=d_old.rate_third_subject;

    d_new.rate_forth_subject=d_old.rate_forth_subject;

}


void Delete(Student* (&d), int& n ){
    int _n;
    cout << "Номер студента, запись которого нужно удалить(от 1 до "<< n <<" ):  ";
    cin >> _n;
    _n--;

    if (_n>0 && _n<n){

        Student* Buffer = new Student[n];
        Copy(Buffer, d, n);
        n--;

        d=new Student[n];
        int q=0;

        for(int i{}; i<n; i++){
            if(i!=_n){
                d[q]=Buffer[i];
                q++;
            }
        }

        delete[]Buffer;
        cout << "Данные удалены" << endl;

    }
    else{
        cout << "Студента с таким номером нет в списке" << endl;
    }


}

void Add_Data(Student* (&d), int &n ){

    Student* Buffer = new Student[n];

    Copy(Buffer, d, n);
    n++;

    d=new Student[n];

    Copy(d, Buffer, --n);

    int i=n;

    cout <<"Введите Фамилию, Имя и Отчество студента через Enter:  " << endl;
    cin >> d[i].surname;
    cin >> d[i].name;
    cin >> d[i].patronymic;

    cout << "Введите год поступления"<< endl;
    cin >> d[i].year_enter;

    cout << "Введите группу в которой состоит учащийся"<< endl;
    cin >> d[i].group;

    cout << "Введите оценки по Высокоуровневому программированию:  " << endl;
    cin >>d[i].rate_first_subject;

    cout << "Введите оценки по культурологии, аналитической геометрии и мат. анализу: " << endl;
    cin >>d[i].rate_second_subject;

    cout << "Введите оценки по аналитической геометрии:  " << endl;
    cin >>d[i].rate_third_subject;

    cout << "Введите оценки по математическому анализу: " << endl;
    cin >>d[i].rate_forth_subject;
    cout << "____________________________________________________________________________" << endl;



    cout << "Данные добавлены!" << endl;
    delete[]Buffer;



}

void Sorting(Student* d, int n){

    Student Buffer;

    for(int i{}; i<n; i++){
        for (int j=i+1; j<n; j++ ){
            if(d[i].surname > d[j].surname){
                Copy_Elements(Buffer, d[j]);
                Copy_Elements(d[j], d[i]);
                Copy_Elements(d[i], Buffer);
            }
        }

    }
    cout << "Данные отсортированы!" << endl;


}

int main(){
    int actions{}, amount_of_data{};
    Student* d=new Student[amount_of_data];


    Menu();
    while(option!=0){
        switch(option){

            case 1: //add

                cout << "Ввод вручную или из файла?"<< endl << "Введите 1 или 2 соответственно"<<endl;
                cin >> actions;
                if(actions==1){
                    Data_Entery(d, amount_of_data);
                }
                else{
                    // файлом
                }
                Menu();
                break;

            case 2: //cout

                if(amount_of_data!=0){
                    Print(d, amount_of_data);
                }
                else{
                    cout << "Данных нет"<< endl ;
                }
                Menu();
                break;

            case 3: //change

                if(amount_of_data!=0){
                    Data_Change(d, amount_of_data);
                }
                else{
                    cout << "Список студентов пуст!"<< endl;
                }
                Menu();
                break;

            case 4: //delete

                if(amount_of_data!=0){
                    Delete(d, amount_of_data);
                }
                else{
                    cout << "Список студентов пуст!"<< endl;
                }
                Menu();


                break;
            case 5: // add data
                if(amount_of_data!=0){
                    Add_Data(d, amount_of_data);
                    amount_of_data++;
                }
                else{
                    int choice{};
                    cout << "Таблица пуста, но давайте её заполним!" << endl;
                    cout <<"Если хотите ввести данные больше,чем об одном студенте нажмите 1, если только одного 2"<< endl;
                    cin >> choice;
                    if(choice==1){
                        Add_Data(d, amount_of_data);
                    }
                    else if(choice ==2 ){
                        Data_Entery(d, amount_of_data);

                    }
                    else{
                        cout << "Ошибка! Введено неверное значение"<< endl;
                    }
                    Menu();
                    break;
                }


                break;
            case 6: // sorting
                if(amount_of_data!=0){
                    Sorting(d, amount_of_data);
                }
                else{
                    cout << "Список студентов пуст!"<< endl;
                }
                Menu();

                break;
            case 7 :
                cout << "Пока - пока!"<< endl;
                abort();
            default:
                cout << "Неверно выбранная опция, попробуйте еще раз!" << endl;
                Menu();



        }
    }

    return 0;

}
